# TMDB 搜索工具 - 优化路线图

> 本文档记录了项目的优化建议和实施计划，按优先级和难度分阶段进行。

## 📊 项目现状评估

### 已实现功能
- ✅ 基础搜索功能（电影/电视剧）
- ✅ 搜索历史记录
- ✅ 暗黑模式切换
- ✅ 海报下载（多尺寸）
- ✅ TMDB ID 复制
- ✅ 响应式设计

### 技术栈
- 纯前端实现（HTML + CSS + JavaScript）
- 无构建工具依赖
- 文件规模：script.js (679行), style.css (995行)

---

## 🎯 第一阶段：快速见效优化（1-2天）

### 1.1 搜索体验优化 ⭐⭐⭐⭐⭐ ✅
**优先级：最高** | **难度：低** | **完成日期：2025-01-08**

- [x] ~~**实现搜索防抖（Debounce）**~~ **已移除**
  - ❌ ~~输入停止 500ms 后自动搜索~~ （用户反馈：需要手动点击搜索）
  - 保留：点击历史记录直接搜索

- [x] **添加搜索加载动画**
  - ✅ 使用 CSS 骨架屏代替简单的"搜索中..."
  - ✅ 提升等待时的用户体验

- [x] **键盘快捷键支持**
  - ✅ `/` 聚焦搜索框
  - ✅ `Esc` 清空搜索/关闭结果
  - ✅ `Ctrl/Cmd+K` 快速搜索
  - ⏸️ `↑↓` 在结果间导航（待实现）

**实施效果：**
- ~~搜索体验显著提升，自动搜索减少了点击操作~~
- 保持手动搜索，避免过多API请求
- 骨架屏动画让等待过程更流畅
- 快捷键提高了操作效率
- 优化了快捷键提示在暗黑模式下的可见性
- 修复了错误提示的暗黑模式适配

### 1.2 结果展示优化 ⭐⭐⭐⭐
**优先级：高** | **难度：低**

- [ ] **实现结果缓存**
  ```javascript
  // 使用 Map 缓存搜索结果
  const searchCache = new Map();
  // 缓存键：`${query}_${mediaType}`
  // 缓存时间：30分钟
  ```

- [ ] **图片懒加载**
  - 使用 Intersection Observer API
  - 只加载可视区域的海报图片

- [ ] **添加"加载更多"按钮**
  - 初始显示 20 条结果
  - 点击加载下一批

### 1.3 用户反馈优化 ⭐⭐⭐⭐
**优先级：高** | **难度：低**

- [ ] **Toast 提示组件**
  - 复制成功提示
  - 错误提示
  - 下载开始/完成提示

- [ ] **网络错误重试**
  - API 请求失败自动重试（最多3次）
  - 显示重试按钮

---

## 🚀 第二阶段：功能增强（3-5天）

### 2.1 高级搜索功能 ⭐⭐⭐⭐
**优先级：中** | **难度：中**

- [ ] **搜索建议/自动完成**
  - 基于历史记录的建议
  - 热门搜索推荐

- [ ] **高级筛选器**
  ```javascript
  // 筛选参数
  {
    year: { min: 2020, max: 2024 },
    rating: { min: 7.0 },
    genre: ['动作', '科幻'],
    language: 'zh'
  }
  ```

- [ ] **批量搜索**
  - 支持逗号分隔的多个片名
  - 批量显示结果

### 2.2 收藏功能 ⭐⭐⭐
**优先级：中** | **难度：中**

- [ ] **本地收藏夹**
  ```javascript
  // localStorage 结构
  {
    favorites: [
      { id, title, poster, type, addedAt }
    ],
    collections: {
      "想看": [...],
      "已看": [...]
    }
  }
  ```

- [ ] **收藏管理界面**
  - 分类查看
  - 批量操作
  - 导出功能

### 2.3 数据导出 ⭐⭐⭐
**优先级：中** | **难度：低**

- [ ] **导出搜索结果**
  - CSV 格式（Excel 可打开）
  - JSON 格式（程序使用）
  - 纯文本格式

---

## 💡 第三阶段：性能与架构优化（1周）

### 3.1 代码重构 ⭐⭐⭐⭐
**优先级：中** | **难度：高**

- [ ] **模块化拆分**
  ```
  src/
  ├── api/
  │   └── tmdb.js        # API 调用
  ├── components/
  │   ├── search.js      # 搜索组件
  │   ├── results.js     # 结果组件
  │   └── history.js     # 历史组件
  ├── utils/
  │   ├── cache.js       # 缓存工具
  │   ├── storage.js     # 存储工具
  │   └── dom.js         # DOM 操作
  └── main.js            # 入口文件
  ```

- [ ] **使用构建工具**
  - Vite 配置
  - 代码分割
  - Tree-shaking

### 3.2 性能优化 ⭐⭐⭐
**优先级：中** | **难度：中**

- [ ] **虚拟滚动**
  - 处理大量结果时只渲染可见项
  - 使用 virtual-list 库

- [ ] **Web Worker**
  - 将数据处理移至 Worker
  - 避免阻塞主线程

- [ ] **资源优化**
  - CSS 精简（移除未使用样式）
  - JavaScript 压缩
  - 图片格式优化（WebP）

### 3.3 PWA 支持 ⭐⭐
**优先级：低** | **难度：中**

- [ ] **Service Worker**
  - 离线缓存
  - 后台同步

- [ ] **Manifest 配置**
  - 应用图标
  - 启动画面
  - 主题色

---

## 🔧 第四阶段：高级功能（2周）

### 4.1 详细信息展示 ⭐⭐⭐
**优先级：低** | **难度：高**

- [ ] **影片详情页**
  - 演员表
  - 相似推荐
  - 预告片播放
  - 用户评论

### 4.2 个性化功能 ⭐⭐
**优先级：低** | **难度：中**

- [ ] **观看记录**
- [ ] **个人评分**
- [ ] **观影统计**

### 4.3 社交功能 ⭐
**优先级：低** | **难度：高**

- [ ] **分享功能**
- [ ] **推荐列表**

---

## 🛡️ 第五阶段：安全与部署（持续）

### 5.1 安全加固 ⭐⭐⭐⭐⭐
**优先级：高** | **难度：中**

- [ ] **API 密钥保护**
  ```javascript
  // 方案1：使用环境变量
  // 方案2：创建后端代理
  // 方案3：使用 Netlify Functions
  ```

- [ ] **输入验证**
  - XSS 防护
  - 特殊字符过滤

### 5.2 部署优化 ⭐⭐⭐
**优先级：中** | **难度：低**

- [ ] **CDN 配置**
- [ ] **Gzip 压缩**
- [ ] **浏览器缓存策略**

---

## 📈 实施建议

### 快速启动（第1周）
1. 先完成第一阶段的所有优化
2. 这些改动对现有代码影响最小
3. 用户体验提升最明显

### 稳步推进（第2-3周）
1. 根据用户反馈选择第二阶段功能
2. 可以并行进行部分第三阶段优化

### 长期规划（1个月后）
1. 考虑是否需要重构为现代框架（React/Vue）
2. 评估是否需要后端支持
3. 用户数据分析和个性化推荐

---

## 📝 技术债务记录

### 当前问题
1. **代码组织**：单文件过大，维护困难
2. **API 密钥**：硬编码在前端，存在安全风险
3. **错误处理**：需要更完善的错误边界
4. **测试覆盖**：缺少单元测试和集成测试

### 解决方案
- 逐步模块化
- 添加 ESLint 配置
- 引入测试框架（Jest）
- 编写开发文档

---

## 🎉 完成标记

完成某项优化后，请在对应项目前打勾，并记录：
- 完成日期
- 实施效果
- 遇到的问题
- 下一步计划

---

*最后更新：2025-01-08*
*维护者：CCFUN*

## 📋 更新日志

### 2025-01-08
- ✅ 完成 1.1 搜索体验优化
  - 实现搜索防抖功能
  - 添加骨架屏加载动画
  - 实现键盘快捷键（部分）
  - 优化快捷键提示样式